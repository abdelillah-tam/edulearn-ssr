<div class="flex min-h-dvh flex-col">
  <header
    class="top-0 z-50 w-full border-b border-b-gray-300 bg-white px-4 md:px-8"
  >
    <app-navigation></app-navigation>
  </header>
  <main class="relative grow">
    @if (course().modules) {
      <ul class="flex flex-col md:flex-row md:gap-4 md:px-8 md:py-8">
        <li class="basis-2/3">
          <video (ended)="onVideoEnded()" controls>
            <source
              src="https://firebasestorage.googleapis.com/v0/b/feedmedia-572e2.appspot.com/o/video.mp4?alt=media&token=c526e0e9-0a97-4a60-b05b-b1d1d2370c7c"
              type="video/mp4"
            />
          </video>
        </li>
        <li
          class="mx-4 my-8 basis-1/3 overflow-hidden rounded-xl border border-gray-300 bg-white py-2 md:mx-0 md:my-0"
        >
          <p class="p-4 text-lg font-bold">Course Content</p>
          <ul class="flex flex-col">
            @for (
              moduleItem of course().modules;
              track $index;
              let moduleIndex = $index
            ) {
              <li class="px-10 py-2 font-bold">{{ moduleItem.module }}</li>
              <ul class="flex flex-col items-center">
                @for (
                  lessonItem of moduleItem.lessons;
                  track $index;
                  let lessonIndex = $index
                ) {
                  <li
                    class="border-red-theme flex w-full cursor-pointer items-center gap-2 p-4"
                    (click)="moveToLesson(moduleIndex, lessonIndex)"
                    [class.border-s-4]="lessonItem.id == lessonId"
                    [class.bg-red-100]="lessonItem.id == lessonId"
                    [class.hover:bg-red-50]="lessonItem.id != lessonId"
                  >
                    <div class="flex items-center">
                      @if (lessonItem.watched) {
                        <mat-icon class="material-symbols-rounded watched"
                          >check_circle</mat-icon
                        >
                      } @else {
                        <mat-icon class="material-symbols-rounded video"
                          >play_circle</mat-icon
                        >
                      }
                    </div>
                    <div class="flex w-full flex-col justify-between gap-1">
                      <p>{{ lessonItem.lesson }}</p>
                      <p class="text-gray-500">{{ lessonItem.duration }}</p>
                    </div>
                  </li>
                }
              </ul>
            }
          </ul>
        </li>
      </ul>
    } @else {
      <loading
        class="absolute h-full w-full"
        [isLoading]="isLoading"
        [diameter]="40"
      ></loading>
    }
  </main>
  <footer>
    <app-footer></app-footer>
  </footer>
</div>
