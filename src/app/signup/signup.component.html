<div class="flex min-h-dvh flex-col">
  <main
    class="flex w-full grow items-center justify-center px-4 py-8 md:px-8 md:py-0"
  >
    <ul
      class="flex h-full w-full flex-col items-center justify-evenly gap-4 md:flex-row md:gap-0"
    >
      <li
        class="flex cursor-pointer flex-col items-center gap-4 select-none md:basis-1/3"
        routerLink="/"
      >
        <div class="bg-red-theme flex rounded-xl p-2">
          <mat-icon
            class="material-symbols-rounded mat-icon"
            fontIcon="school"
          ></mat-icon>
        </div>
        <h1 class="text-center text-lg">EduLearn Platform</h1>
      </li>

      <li
        class="flex w-full flex-col rounded-xl border border-gray-300 md:basis-1/3"
      >
        <div class="flex flex-col gap-2 p-4">
          <p class="font-bold">Welcome Back</p>
          <p class="text-gray-500">Sign in to your account</p>
        </div>
        <form
          class="flex w-full flex-col gap-4 p-4"
          [formGroup]="signupFormGroup"
        >
          @let fullnameControl = signupFormGroup.controls.fullname;
          @let emailControl = signupFormGroup.controls.email;
          @let passwordControl = signupFormGroup.controls.password;
          @let passwordConfirmationControl =
            signupFormGroup.controls.password_confirmation;

          <ul class="flex w-full justify-between rounded-xl bg-red-100 p-1">
            <li class="flex basis-1/2 justify-center">
              <label
                class="flex w-full cursor-pointer appearance-none justify-center rounded-xl py-1 font-bold"
                [class.bg-white]="selectedType === 0"
              >
                <input
                  type="radio"
                  formControlName="type"
                  class="appearance-none"
                  value="Student"
                  name="type"
                  (click)="selectType(0)"
                />
                Student</label
              >
            </li>
            <li class="flex basis-1/2 cursor-pointer justify-center">
              <label
                class="flex w-full cursor-pointer justify-center rounded-xl py-1 font-bold"
                [class.bg-white]="selectedType === 1"
              >
                <input
                  type="radio"
                  (click)="selectType(1)"
                  formControlName="type"
                  class="appearance-none"
                  value="Instructor"
                  name="type"
                />
                Instructor
              </label>
            </li>
          </ul>

          <div
            class="grid w-full grid-rows-[1fr_calc(var(--spacing)*10)_1fr] gap-1"
          >
            <label for="fullname" class="font-bold">Full Name</label>
            <input
              class="input-style"
              type="text"
              placeholder="Ayoub Tamoussat"
              name="fullname"
              [formControl]="fullnameControl"
              required
            />
            @if (fullnameControl.invalid && fullnameControl.touched) {
              <p class="error">This field is required</p>
            }
          </div>

          <div
            class="grid w-full grid-rows-[1fr_calc(var(--spacing)*10)_1fr] gap-1"
          >
            <label for="email" class="font-bold">Email</label>
            <input
              class="input-style"
              type="email"
              placeholder="student@example.com"
              name="email"
              [formControl]="emailControl"
              required
            />
            @if (emailControl.invalid && emailControl.touched) {
              @if (emailControl.errors?.["required"]) {
                <p class="error">This field is required</p>
              } @else if (emailControl.errors?.["email"]) {
                <p class="error">Enter a valid email</p>
              }
            }
          </div>

          <div
            class="grid w-full grid-rows-[1fr_calc(var(--spacing)*10)_1fr] gap-1"
          >
            <label for="password" class="font-bold">Password</label>
            <input
              class="input-style"
              type="password"
              placeholder="••••••••"
              name="password"
              [formControl]="passwordControl"
              required
            />
            @if (passwordControl.invalid && passwordControl.touched) {
              @if (passwordControl.errors?.["required"]) {
                <p class="error">This field is required</p>
              }
            }
          </div>

          <div
            class="grid w-full grid-rows-[1fr_calc(var(--spacing)*10)_1fr] gap-1"
          >
            <label for="password_confirmation" class="font-bold"
              >Confirm Password</label
            >
            <input
              class="input-style"
              type="password"
              placeholder="••••••••"
              name="password_confirmation"
              [formControl]="passwordConfirmationControl"
              required
            />
            @if (
              passwordConfirmationControl.invalid &&
              passwordConfirmationControl.touched
            ) {
              @if (passwordConfirmationControl.errors?.["required"]) {
                <p class="error">This field is required</p>
              }
            } @else if (signupFormGroup.errors?.["passwordMismatch"]) {
              <p class="error">Passwords do not match</p>
            }
          </div>

          <button
            type="button"
            class="red-btn flex items-center justify-center"
            (click)="signup()"
            [disabled]="isSignupLoading"
          >
            @if (isSignupLoading) {
              <mat-spinner class="signup-loading" [diameter]="25"></mat-spinner>
            } @else {
              @if (selectedType === 0) {
                Create Student Account
              } @else {
                Create Instructor Account
              }
            }
          </button>

          <p class="w-full text-center text-xs text-gray-500">
            By signing up, you agree to our Terms of Service
          </p>

          <button type="button" class="w-full text-gray-500">
            Already have an account?
            <a
              class="text-red-theme cursor-pointer hover:underline"
              routerLink="/signin"
              >Sign in</a
            >
          </button>
        </form>
      </li>
    </ul>
  </main>
</div>
